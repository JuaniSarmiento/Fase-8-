2026-02-03 13:17:11 - watchfiles.main - INFO - _log_changes:308 - 2 changes detected
2026-02-03 13:17:51 - watchfiles.main - INFO - _log_changes:308 - 4 changes detected
2026-02-03 13:18:34 - watchfiles.main - INFO - _log_changes:308 - 98 changes detected
2026-02-03 13:18:34 - watchfiles.main - INFO - _log_changes:308 - 1 change detected
2026-02-03 13:18:34 - root - INFO - setup_logging:116 - ============================================================
2026-02-03 13:18:34 - root - INFO - setup_logging:117 - ðŸš€ AI-Native MVP V3 - Logging initialized
2026-02-03 13:18:34 - root - INFO - setup_logging:118 - ðŸ“ Log Level: INFO
2026-02-03 13:18:34 - root - INFO - setup_logging:119 - ðŸ“ Log Directory: /app/logs
2026-02-03 13:18:34 - root - INFO - setup_logging:120 - ðŸ’¾ File Logging: âœ… Enabled
2026-02-03 13:18:34 - root - INFO - setup_logging:121 - ðŸ”” Sentry Alerts: âŒ Disabled
2026-02-03 13:18:34 - root - INFO - setup_logging:122 - ============================================================
2026-02-03 13:18:34 - root - INFO - setup_logging:116 - ============================================================
2026-02-03 13:18:34 - root - INFO - setup_logging:117 - ðŸš€ AI-Native MVP V3 - Logging initialized
2026-02-03 13:18:34 - root - INFO - setup_logging:118 - ðŸ“ Log Level: INFO
2026-02-03 13:18:34 - root - INFO - setup_logging:119 - ðŸ“ Log Directory: /app/logs
2026-02-03 13:18:34 - root - INFO - setup_logging:120 - ðŸ’¾ File Logging: âœ… Enabled
2026-02-03 13:18:34 - root - INFO - setup_logging:121 - ðŸ”” Sentry Alerts: âŒ Disabled
2026-02-03 13:18:34 - root - INFO - setup_logging:122 - ============================================================
2026-02-03 13:18:36 - watchfiles.main - INFO - _log_changes:308 - 52 changes detected
2026-02-03 13:18:42 - backend.src_v3.infrastructure.http.app - INFO - create_app:175 - Application created successfully
2026-02-03 13:18:42 - backend.src_v3.infrastructure.http.app - INFO - create_app:175 - Application created successfully
2026-02-03 13:18:42 - backend.src_v3.infrastructure.http.app - INFO - lifespan:53 - Starting AI-Native MVP V3 (Clean Architecture)
2026-02-03 13:18:42 - backend.src_v3.infrastructure.http.app - INFO - lifespan:54 - Initializing database connection...
2026-02-03 13:19:12 - watchfiles.main - INFO - _log_changes:308 - 120 changes detected
2026-02-03 13:19:12 - backend.src_v3.infrastructure.http.app - INFO - lifespan:65 - Shutting down application...
2026-02-03 13:19:12 - root - INFO - setup_logging:116 - ============================================================
2026-02-03 13:19:12 - root - INFO - setup_logging:117 - ðŸš€ AI-Native MVP V3 - Logging initialized
2026-02-03 13:19:12 - root - INFO - setup_logging:118 - ðŸ“ Log Level: INFO
2026-02-03 13:19:12 - root - INFO - setup_logging:119 - ðŸ“ Log Directory: /app/logs
2026-02-03 13:19:12 - root - INFO - setup_logging:120 - ðŸ’¾ File Logging: âœ… Enabled
2026-02-03 13:19:12 - root - INFO - setup_logging:121 - ðŸ”” Sentry Alerts: âŒ Disabled
2026-02-03 13:19:12 - root - INFO - setup_logging:122 - ============================================================
2026-02-03 13:19:12 - root - INFO - setup_logging:116 - ============================================================
2026-02-03 13:19:12 - root - INFO - setup_logging:117 - ðŸš€ AI-Native MVP V3 - Logging initialized
2026-02-03 13:19:12 - root - INFO - setup_logging:118 - ðŸ“ Log Level: INFO
2026-02-03 13:19:12 - root - INFO - setup_logging:119 - ðŸ“ Log Directory: /app/logs
2026-02-03 13:19:12 - root - INFO - setup_logging:120 - ðŸ’¾ File Logging: âœ… Enabled
2026-02-03 13:19:12 - root - INFO - setup_logging:121 - ðŸ”” Sentry Alerts: âŒ Disabled
2026-02-03 13:19:12 - root - INFO - setup_logging:122 - ============================================================
2026-02-03 13:19:12 - watchfiles.main - INFO - _log_changes:308 - 1 change detected
2026-02-03 13:19:14 - watchfiles.main - INFO - _log_changes:308 - 3 changes detected
2026-02-03 13:19:18 - backend.src_v3.infrastructure.http.app - INFO - create_app:175 - Application created successfully
2026-02-03 13:19:19 - backend.src_v3.infrastructure.http.app - INFO - create_app:175 - Application created successfully
2026-02-03 13:19:19 - backend.src_v3.infrastructure.http.app - INFO - lifespan:53 - Starting AI-Native MVP V3 (Clean Architecture)
2026-02-03 13:19:19 - backend.src_v3.infrastructure.http.app - INFO - lifespan:54 - Initializing database connection...
2026-02-03 13:19:53 - watchfiles.main - INFO - _log_changes:308 - 5 changes detected
2026-02-03 13:19:54 - watchfiles.main - INFO - _log_changes:308 - 7 changes detected
2026-02-03 13:19:54 - backend.src_v3.infrastructure.http.app - INFO - lifespan:65 - Shutting down application...
2026-02-03 13:19:54 - root - INFO - setup_logging:116 - ============================================================
2026-02-03 13:19:54 - root - INFO - setup_logging:117 - ðŸš€ AI-Native MVP V3 - Logging initialized
2026-02-03 13:19:54 - root - INFO - setup_logging:118 - ðŸ“ Log Level: INFO
2026-02-03 13:19:54 - root - INFO - setup_logging:119 - ðŸ“ Log Directory: /app/logs
2026-02-03 13:19:54 - root - INFO - setup_logging:120 - ðŸ’¾ File Logging: âœ… Enabled
2026-02-03 13:19:54 - root - INFO - setup_logging:121 - ðŸ”” Sentry Alerts: âŒ Disabled
2026-02-03 13:19:54 - root - INFO - setup_logging:122 - ============================================================
2026-02-03 13:19:54 - root - INFO - setup_logging:116 - ============================================================
2026-02-03 13:19:54 - root - INFO - setup_logging:117 - ðŸš€ AI-Native MVP V3 - Logging initialized
2026-02-03 13:19:54 - root - INFO - setup_logging:118 - ðŸ“ Log Level: INFO
2026-02-03 13:19:54 - root - INFO - setup_logging:119 - ðŸ“ Log Directory: /app/logs
2026-02-03 13:19:54 - root - INFO - setup_logging:120 - ðŸ’¾ File Logging: âœ… Enabled
2026-02-03 13:19:54 - root - INFO - setup_logging:121 - ðŸ”” Sentry Alerts: âŒ Disabled
2026-02-03 13:19:54 - root - INFO - setup_logging:122 - ============================================================
2026-02-03 13:19:55 - watchfiles.main - INFO - _log_changes:308 - 4 changes detected
2026-02-03 13:20:00 - backend.src_v3.infrastructure.http.app - INFO - create_app:175 - Application created successfully
2026-02-03 13:20:00 - backend.src_v3.infrastructure.http.app - INFO - create_app:175 - Application created successfully
2026-02-03 13:20:00 - backend.src_v3.infrastructure.http.app - INFO - lifespan:53 - Starting AI-Native MVP V3 (Clean Architecture)
2026-02-03 13:20:00 - backend.src_v3.infrastructure.http.app - INFO - lifespan:54 - Initializing database connection...
2026-02-03 13:20:33 - watchfiles.main - INFO - _log_changes:308 - 10 changes detected
2026-02-03 13:20:34 - watchfiles.main - INFO - _log_changes:308 - 1 change detected
2026-02-03 13:21:05 - watchfiles.main - INFO - _log_changes:308 - 2 changes detected
2026-02-03 13:21:40 - watchfiles.main - INFO - _log_changes:308 - 2 changes detected
2026-02-03 13:22:22 - watchfiles.main - INFO - _log_changes:308 - 2 changes detected
2026-02-03 13:22:23 - watchfiles.main - INFO - _log_changes:308 - 1 change detected
2026-02-03 13:22:24 - watchfiles.main - INFO - _log_changes:308 - 1 change detected
2026-02-03 13:22:24 - watchfiles.main - INFO - _log_changes:308 - 1 change detected
2026-02-03 13:23:02 - watchfiles.main - INFO - _log_changes:308 - 2 changes detected
2026-02-03 13:23:02 - watchfiles.main - INFO - _log_changes:308 - 1 change detected
2026-02-03 13:23:32 - watchfiles.main - INFO - _log_changes:308 - 2 changes detected
2026-02-03 13:23:32 - watchfiles.main - INFO - _log_changes:308 - 1 change detected
2026-02-03 13:23:32 - backend.src_v3.infrastructure.http.app - INFO - lifespan:65 - Shutting down application...
2026-02-03 13:23:32 - root - INFO - setup_logging:116 - ============================================================
2026-02-03 13:23:32 - root - INFO - setup_logging:117 - ðŸš€ AI-Native MVP V3 - Logging initialized
2026-02-03 13:23:32 - root - INFO - setup_logging:118 - ðŸ“ Log Level: INFO
2026-02-03 13:23:32 - root - INFO - setup_logging:119 - ðŸ“ Log Directory: /app/logs
2026-02-03 13:23:32 - root - INFO - setup_logging:120 - ðŸ’¾ File Logging: âœ… Enabled
2026-02-03 13:23:32 - root - INFO - setup_logging:121 - ðŸ”” Sentry Alerts: âŒ Disabled
2026-02-03 13:23:32 - root - INFO - setup_logging:122 - ============================================================
2026-02-03 13:23:32 - root - INFO - setup_logging:116 - ============================================================
2026-02-03 13:23:32 - root - INFO - setup_logging:117 - ðŸš€ AI-Native MVP V3 - Logging initialized
2026-02-03 13:23:32 - root - INFO - setup_logging:118 - ðŸ“ Log Level: INFO
2026-02-03 13:23:32 - root - INFO - setup_logging:119 - ðŸ“ Log Directory: /app/logs
2026-02-03 13:23:32 - root - INFO - setup_logging:120 - ðŸ’¾ File Logging: âœ… Enabled
2026-02-03 13:23:32 - root - INFO - setup_logging:121 - ðŸ”” Sentry Alerts: âŒ Disabled
2026-02-03 13:23:32 - root - INFO - setup_logging:122 - ============================================================
2026-02-03 13:23:38 - backend.src_v3.infrastructure.http.app - INFO - create_app:175 - Application created successfully
2026-02-03 13:23:38 - backend.src_v3.infrastructure.http.app - INFO - create_app:175 - Application created successfully
2026-02-03 13:23:38 - backend.src_v3.infrastructure.http.app - INFO - lifespan:53 - Starting AI-Native MVP V3 (Clean Architecture)
2026-02-03 13:23:38 - backend.src_v3.infrastructure.http.app - INFO - lifespan:54 - Initializing database connection...
2026-02-03 13:24:05 - watchfiles.main - INFO - _log_changes:308 - 2 changes detected
2026-02-03 13:24:06 - watchfiles.main - INFO - _log_changes:308 - 2 changes detected
2026-02-03 13:24:35 - watchfiles.main - INFO - _log_changes:308 - 2 changes detected
2026-02-03 13:25:11 - watchfiles.main - INFO - _log_changes:308 - 62 changes detected
2026-02-03 13:25:11 - backend.src_v3.infrastructure.http.app - INFO - lifespan:65 - Shutting down application...
2026-02-03 13:25:12 - root - INFO - setup_logging:116 - ============================================================
2026-02-03 13:25:12 - root - INFO - setup_logging:117 - ðŸš€ AI-Native MVP V3 - Logging initialized
2026-02-03 13:25:12 - root - INFO - setup_logging:118 - ðŸ“ Log Level: INFO
2026-02-03 13:25:12 - root - INFO - setup_logging:119 - ðŸ“ Log Directory: /app/logs
2026-02-03 13:25:12 - root - INFO - setup_logging:120 - ðŸ’¾ File Logging: âœ… Enabled
2026-02-03 13:25:12 - root - INFO - setup_logging:121 - ðŸ”” Sentry Alerts: âŒ Disabled
2026-02-03 13:25:12 - root - INFO - setup_logging:122 - ============================================================
2026-02-03 13:25:12 - root - INFO - setup_logging:116 - ============================================================
2026-02-03 13:25:12 - root - INFO - setup_logging:117 - ðŸš€ AI-Native MVP V3 - Logging initialized
2026-02-03 13:25:12 - root - INFO - setup_logging:118 - ðŸ“ Log Level: INFO
2026-02-03 13:25:12 - root - INFO - setup_logging:119 - ðŸ“ Log Directory: /app/logs
2026-02-03 13:25:12 - root - INFO - setup_logging:120 - ðŸ’¾ File Logging: âœ… Enabled
2026-02-03 13:25:12 - root - INFO - setup_logging:121 - ðŸ”” Sentry Alerts: âŒ Disabled
2026-02-03 13:25:12 - root - INFO - setup_logging:122 - ============================================================
2026-02-03 13:25:17 - backend.src_v3.infrastructure.http.app - INFO - create_app:175 - Application created successfully
2026-02-03 13:25:17 - backend.src_v3.infrastructure.http.app - INFO - create_app:175 - Application created successfully
2026-02-03 13:25:17 - backend.src_v3.infrastructure.http.app - INFO - lifespan:53 - Starting AI-Native MVP V3 (Clean Architecture)
2026-02-03 13:25:17 - backend.src_v3.infrastructure.http.app - INFO - lifespan:54 - Initializing database connection...
2026-02-03 13:25:44 - watchfiles.main - INFO - _log_changes:308 - 21 changes detected
2026-02-03 13:25:44 - backend.src_v3.infrastructure.http.app - INFO - lifespan:65 - Shutting down application...
2026-02-03 13:25:45 - root - INFO - setup_logging:116 - ============================================================
2026-02-03 13:25:45 - root - INFO - setup_logging:117 - ðŸš€ AI-Native MVP V3 - Logging initialized
2026-02-03 13:25:45 - root - INFO - setup_logging:118 - ðŸ“ Log Level: INFO
2026-02-03 13:25:45 - root - INFO - setup_logging:119 - ðŸ“ Log Directory: /app/logs
2026-02-03 13:25:45 - root - INFO - setup_logging:120 - ðŸ’¾ File Logging: âœ… Enabled
2026-02-03 13:25:45 - root - INFO - setup_logging:121 - ðŸ”” Sentry Alerts: âŒ Disabled
2026-02-03 13:25:45 - root - INFO - setup_logging:122 - ============================================================
2026-02-03 13:25:45 - root - INFO - setup_logging:116 - ============================================================
2026-02-03 13:25:45 - root - INFO - setup_logging:117 - ðŸš€ AI-Native MVP V3 - Logging initialized
2026-02-03 13:25:45 - root - INFO - setup_logging:118 - ðŸ“ Log Level: INFO
2026-02-03 13:25:45 - root - INFO - setup_logging:119 - ðŸ“ Log Directory: /app/logs
2026-02-03 13:25:45 - root - INFO - setup_logging:120 - ðŸ’¾ File Logging: âœ… Enabled
2026-02-03 13:25:45 - root - INFO - setup_logging:121 - ðŸ”” Sentry Alerts: âŒ Disabled
2026-02-03 13:25:45 - root - INFO - setup_logging:122 - ============================================================
2026-02-03 13:25:45 - watchfiles.main - INFO - _log_changes:308 - 1 change detected
2026-02-03 13:25:51 - backend.src_v3.infrastructure.http.app - INFO - create_app:175 - Application created successfully
2026-02-03 13:25:51 - backend.src_v3.infrastructure.http.app - INFO - create_app:175 - Application created successfully
2026-02-03 13:25:51 - backend.src_v3.infrastructure.http.app - INFO - lifespan:53 - Starting AI-Native MVP V3 (Clean Architecture)
2026-02-03 13:25:51 - backend.src_v3.infrastructure.http.app - INFO - lifespan:54 - Initializing database connection...
2026-02-03 13:26:21 - watchfiles.main - INFO - _log_changes:308 - 2 changes detected
2026-02-03 13:26:21 - watchfiles.main - INFO - _log_changes:308 - 1 change detected
2026-02-03 13:26:49 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - select pg_catalog.version()
2026-02-03 13:26:49 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [raw sql] ()
2026-02-03 13:26:49 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - select current_schema()
2026-02-03 13:26:49 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [raw sql] ()
2026-02-03 13:26:49 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - show standard_conforming_strings
2026-02-03 13:26:49 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [raw sql] ()
2026-02-03 13:26:49 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:49 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT id, username, email, full_name, roles, hashed_password, is_active
            FROM users
            WHERE email = $1
            
2026-02-03 13:26:49 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00137s] ('docente@ainative.edu',)
2026-02-03 13:26:49 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:50 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:50 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT 
                m.module_id,
                m.title as name,
                m.description,
                m.course_id,
                c.subject_code,
                c.year,
                c.semester,
                m.created_at,
                COUNT(DISTINCT e_students.enrollment_id) as student_count
            FROM modules m
            JOIN courses c ON m.course_id = c.course_id
            JOIN enrollments e_teacher ON c.course_id = e_teacher.course_id
            LEFT JOIN enrollments e_students ON m.module_id = e_students.module_id 
                AND e_students.role = 'STUDENT' 
                AND e_students.status = 'ACTIVE'
            WHERE e_teacher.user_id = $1
              AND e_teacher.role = 'TEACHER'
              AND e_teacher.status = 'ACTIVE'
            GROUP BY m.module_id, m.title, m.description, m.course_id, 
                     c.subject_code, c.year, c.semester, m.created_at
            ORDER BY m.created_at DESC
        
2026-02-03 13:26:50 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00209s] ('1be823c5-22aa-4b70-b06d-f7f3ecad978e',)
2026-02-03 13:26:50 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:51 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:51 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT 
                e.enrollment_id,
                e.user_id,
                e.role,
                e.status,
                e.enrolled_at,
                u.full_name,
                u.email
            FROM enrollments e
            JOIN users u ON e.user_id = u.id
            WHERE e.module_id = $1
         AND e.status = $2 ORDER BY e.enrolled_at DESC
2026-02-03 13:26:51 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00395s] ('52738ad0-80d2-47de-8d56-dcd266da25e3', 'ACTIVE')
2026-02-03 13:26:51 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:51 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:51 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT 
                e.enrollment_id,
                e.user_id,
                e.role,
                e.status,
                e.enrolled_at,
                u.full_name,
                u.email
            FROM enrollments e
            JOIN users u ON e.user_id = u.id
            WHERE e.module_id = $1
         AND e.status = $2 ORDER BY e.enrolled_at DESC
2026-02-03 13:26:51 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.04696s ago] ('52738ad0-80d2-47de-8d56-dcd266da25e3', 'ACTIVE')
2026-02-03 13:26:51 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:52 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:52 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT 
                a.activity_id,
                a.title,
                a.instructions,
                a.difficulty,
                a.estimated_duration_minutes,
                a.order_index,
                a.status,
                a.created_at,
                COUNT(DISTINCT s.submission_id) as total_submissions,
                COUNT(DISTINCT CASE WHEN s.status = 'graded' THEN s.submission_id END) as graded_submissions
            FROM activities a
            LEFT JOIN submissions s ON a.activity_id = s.activity_id
            WHERE a.module_id = $1
            GROUP BY a.activity_id
            ORDER BY a.order_index ASC, a.created_at DESC
        
2026-02-03 13:26:52 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00304s] ('52738ad0-80d2-47de-8d56-dcd266da25e3',)
2026-02-03 13:26:52 - backend.src_v3.infrastructure.http.api.v3.routers.teacher_router - INFO - get_module_activities:2523 - ðŸ“Š Module 52738ad0-80d2-47de-8d56-dcd266da25e3 - Found 1 activities
2026-02-03 13:26:52 - backend.src_v3.infrastructure.http.api.v3.routers.teacher_router - INFO - get_module_activities:2540 - ðŸ“Š Returning 1 activities
2026-02-03 13:26:52 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:52 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:52 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT 
                a.activity_id,
                a.title,
                a.instructions,
                a.difficulty,
                a.estimated_duration_minutes,
                a.order_index,
                a.status,
                a.created_at,
                COUNT(DISTINCT s.submission_id) as total_submissions,
                COUNT(DISTINCT CASE WHEN s.status = 'graded' THEN s.submission_id END) as graded_submissions
            FROM activities a
            LEFT JOIN submissions s ON a.activity_id = s.activity_id
            WHERE a.module_id = $1
            GROUP BY a.activity_id
            ORDER BY a.order_index ASC, a.created_at DESC
        
2026-02-03 13:26:52 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.02999s ago] ('52738ad0-80d2-47de-8d56-dcd266da25e3',)
2026-02-03 13:26:52 - backend.src_v3.infrastructure.http.api.v3.routers.teacher_router - INFO - get_module_activities:2523 - ðŸ“Š Module 52738ad0-80d2-47de-8d56-dcd266da25e3 - Found 1 activities
2026-02-03 13:26:52 - backend.src_v3.infrastructure.http.api.v3.routers.teacher_router - INFO - get_module_activities:2540 - ðŸ“Š Returning 1 activities
2026-02-03 13:26:52 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:53 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:53 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT 
                (SELECT COUNT(*) FROM enrollments WHERE module_id = $1 AND status = 'ACTIVE') as active_students,
                (SELECT COUNT(*) FROM activities WHERE module_id = $1) as total_activities,
                (SELECT COUNT(DISTINCT s.student_id) 
                 FROM submissions s 
                 JOIN activities a ON s.activity_id = a.activity_id 
                 WHERE a.module_id = $1) as students_with_submissions,
                (SELECT COUNT(*) 
                 FROM submissions s 
                 JOIN activities a ON s.activity_id = a.activity_id 
                 WHERE a.module_id = $1) as total_submissions,
                (SELECT AVG(s.final_grade) 
                 FROM submissions s 
                 JOIN activities a ON s.activity_id = a.activity_id 
                 WHERE a.module_id = $1 AND s.status = 'graded') as average_grade
        
2026-02-03 13:26:53 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00309s] ('52738ad0-80d2-47de-8d56-dcd266da25e3',)
2026-02-03 13:26:53 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:53 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:53 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT 
                (SELECT COUNT(*) FROM enrollments WHERE module_id = $1 AND status = 'ACTIVE') as active_students,
                (SELECT COUNT(*) FROM activities WHERE module_id = $1) as total_activities,
                (SELECT COUNT(DISTINCT s.student_id) 
                 FROM submissions s 
                 JOIN activities a ON s.activity_id = a.activity_id 
                 WHERE a.module_id = $1) as students_with_submissions,
                (SELECT COUNT(*) 
                 FROM submissions s 
                 JOIN activities a ON s.activity_id = a.activity_id 
                 WHERE a.module_id = $1) as total_submissions,
                (SELECT AVG(s.final_grade) 
                 FROM submissions s 
                 JOIN activities a ON s.activity_id = a.activity_id 
                 WHERE a.module_id = $1 AND s.status = 'graded') as average_grade
        
2026-02-03 13:26:53 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.01901s ago] ('52738ad0-80d2-47de-8d56-dcd266da25e3',)
2026-02-03 13:26:53 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:53 - watchfiles.main - INFO - _log_changes:308 - 2 changes detected
2026-02-03 13:26:54 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:54 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT 
                a.activity_id,
                a.title,
                a.instructions,
                a.difficulty,
                a.estimated_duration_minutes,
                a.order_index,
                a.status,
                a.created_at,
                COUNT(DISTINCT s.submission_id) as total_submissions,
                COUNT(DISTINCT CASE WHEN s.status = 'graded' THEN s.submission_id END) as graded_submissions
            FROM activities a
            LEFT JOIN submissions s ON a.activity_id = s.activity_id
            WHERE a.module_id = $1
            GROUP BY a.activity_id
            ORDER BY a.order_index ASC, a.created_at DESC
        
2026-02-03 13:26:54 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 2.431s ago] ('52738ad0-80d2-47de-8d56-dcd266da25e3',)
2026-02-03 13:26:54 - backend.src_v3.infrastructure.http.api.v3.routers.teacher_router - INFO - get_module_activities:2523 - ðŸ“Š Module 52738ad0-80d2-47de-8d56-dcd266da25e3 - Found 1 activities
2026-02-03 13:26:54 - backend.src_v3.infrastructure.http.api.v3.routers.teacher_router - INFO - get_module_activities:2540 - ðŸ“Š Returning 1 activities
2026-02-03 13:26:54 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:54 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:54 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT 
                a.activity_id,
                a.title,
                a.instructions,
                a.difficulty,
                a.estimated_duration_minutes,
                a.order_index,
                a.status,
                a.created_at,
                COUNT(DISTINCT s.submission_id) as total_submissions,
                COUNT(DISTINCT CASE WHEN s.status = 'graded' THEN s.submission_id END) as graded_submissions
            FROM activities a
            LEFT JOIN submissions s ON a.activity_id = s.activity_id
            WHERE a.module_id = $1
            GROUP BY a.activity_id
            ORDER BY a.order_index ASC, a.created_at DESC
        
2026-02-03 13:26:54 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 2.446s ago] ('52738ad0-80d2-47de-8d56-dcd266da25e3',)
2026-02-03 13:26:54 - backend.src_v3.infrastructure.http.api.v3.routers.teacher_router - INFO - get_module_activities:2523 - ðŸ“Š Module 52738ad0-80d2-47de-8d56-dcd266da25e3 - Found 1 activities
2026-02-03 13:26:54 - backend.src_v3.infrastructure.http.api.v3.routers.teacher_router - INFO - get_module_activities:2540 - ðŸ“Š Returning 1 activities
2026-02-03 13:26:54 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:54 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:54 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT 
                e.enrollment_id,
                e.user_id,
                e.role,
                e.status,
                e.enrolled_at,
                u.full_name,
                u.email
            FROM enrollments e
            JOIN users u ON e.user_id = u.id
            WHERE e.module_id = $1
         AND e.status = $2 ORDER BY e.enrolled_at DESC
2026-02-03 13:26:54 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 3.876s ago] ('52738ad0-80d2-47de-8d56-dcd266da25e3', 'ACTIVE')
2026-02-03 13:26:54 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:54 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:54 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT 
                e.enrollment_id,
                e.user_id,
                e.role,
                e.status,
                e.enrolled_at,
                u.full_name,
                u.email
            FROM enrollments e
            JOIN users u ON e.user_id = u.id
            WHERE e.module_id = $1
         AND e.status = $2 ORDER BY e.enrolled_at DESC
2026-02-03 13:26:54 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 3.886s ago] ('52738ad0-80d2-47de-8d56-dcd266da25e3', 'ACTIVE')
2026-02-03 13:26:54 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:54 - watchfiles.main - INFO - _log_changes:308 - 1 change detected
2026-02-03 13:26:55 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:55 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT 
                a.activity_id,
                a.title,
                a.instructions,
                a.difficulty,
                a.estimated_duration_minutes,
                a.order_index,
                a.status,
                a.created_at,
                COUNT(DISTINCT s.submission_id) as total_submissions,
                COUNT(DISTINCT CASE WHEN s.status = 'graded' THEN s.submission_id END) as graded_submissions
            FROM activities a
            LEFT JOIN submissions s ON a.activity_id = s.activity_id
            WHERE a.module_id = $1
            GROUP BY a.activity_id
            ORDER BY a.order_index ASC, a.created_at DESC
        
2026-02-03 13:26:55 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 4.007s ago] ('52738ad0-80d2-47de-8d56-dcd266da25e3',)
2026-02-03 13:26:55 - backend.src_v3.infrastructure.http.api.v3.routers.teacher_router - INFO - get_module_activities:2523 - ðŸ“Š Module 52738ad0-80d2-47de-8d56-dcd266da25e3 - Found 1 activities
2026-02-03 13:26:55 - backend.src_v3.infrastructure.http.api.v3.routers.teacher_router - INFO - get_module_activities:2540 - ðŸ“Š Returning 1 activities
2026-02-03 13:26:55 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:55 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:55 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT 
                a.activity_id,
                a.title,
                a.instructions,
                a.difficulty,
                a.estimated_duration_minutes,
                a.order_index,
                a.status,
                a.created_at,
                COUNT(DISTINCT s.submission_id) as total_submissions,
                COUNT(DISTINCT CASE WHEN s.status = 'graded' THEN s.submission_id END) as graded_submissions
            FROM activities a
            LEFT JOIN submissions s ON a.activity_id = s.activity_id
            WHERE a.module_id = $1
            GROUP BY a.activity_id
            ORDER BY a.order_index ASC, a.created_at DESC
        
2026-02-03 13:26:55 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 4.02s ago] ('52738ad0-80d2-47de-8d56-dcd266da25e3',)
2026-02-03 13:26:55 - backend.src_v3.infrastructure.http.api.v3.routers.teacher_router - INFO - get_module_activities:2523 - ðŸ“Š Module 52738ad0-80d2-47de-8d56-dcd266da25e3 - Found 1 activities
2026-02-03 13:26:55 - backend.src_v3.infrastructure.http.api.v3.routers.teacher_router - INFO - get_module_activities:2540 - ðŸ“Š Returning 1 activities
2026-02-03 13:26:55 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:55 - watchfiles.main - INFO - _log_changes:308 - 9 changes detected
2026-02-03 13:26:56 - watchfiles.main - INFO - _log_changes:308 - 4 changes detected
2026-02-03 13:26:56 - watchfiles.main - INFO - _log_changes:308 - 4 changes detected
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT activity_id, course_id, teacher_id, title, subject, instructions, status, policies, created_at
            FROM activities
            WHERE activity_id = $1
        
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00325s] ('f31204ea-8711-408b-8bdf-46087f7bef37',)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _connection_rollback_impl:2702 - ROLLBACK
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT DISTINCT
                    u.id as student_id,
                    u.email,
                    u.full_name,
                    COUNT(DISTINCT ex.exercise_id) as total_exercises,
                    COUNT(DISTINCT CASE WHEN att.passed = true THEN ex.exercise_id END) as submitted_exercises,
                    COUNT(DISTINCT CASE WHEN att.passed = true THEN ex.exercise_id END) as graded_exercises,
                    AVG(CASE WHEN att.passed = true THEN 10 ELSE 5 END) as avg_score,
                    MAX(att.submitted_at) as last_submission
                FROM users u
                INNER JOIN sessions_v2 s ON s.user_id = u.id
                CROSS JOIN exercises_v2 ex
                LEFT JOIN exercise_attempts_v2 att ON att.exercise_id = ex.exercise_id AND att.user_id = u.id
                WHERE s.activity_id = $1
                AND u.roles @> '["student"]'::jsonb
                GROUP BY u.id, u.email, u.full_name
                ORDER BY u.full_name
            
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00278s] ('f31204ea-8711-408b-8bdf-46087f7bef37',)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - SELECT activities.activity_id, activities.title, activities.subject, activities.unit_id, activities.teacher_id, activities.course_id, activities.module_id, activities.order_index, activities.instructions, activities.status, activities.difficulty_level, activities.policies, activities.start_date, activities.end_date, activities.created_at, activities.deleted_at 
FROM activities 
WHERE activities.activity_id = $1::VARCHAR
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00396s] ('f31204ea-8711-408b-8bdf-46087f7bef37',)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT activity_id, course_id, teacher_id, title, subject, instructions, status, policies, created_at
            FROM activities
            WHERE activity_id = $1
        
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.09192s ago] ('f31204ea-8711-408b-8bdf-46087f7bef37',)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT activity_id, course_id, teacher_id, title, subject, instructions, status, policies, created_at
            FROM activities
            WHERE activity_id = $1
        
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.1033s ago] ('f31204ea-8711-408b-8bdf-46087f7bef37',)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT exercise_id, title, description, difficulty, language, 
                       mission_markdown, starter_code, solution_code, test_cases
                FROM exercises_v2
                WHERE activity_id = $1
                ORDER BY created_at ASC
                
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00268s] ('f31204ea-8711-408b-8bdf-46087f7bef37',)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - SELECT sessions_v2.session_id, sessions_v2.user_id, sessions_v2.activity_id, sessions_v2.course_id, sessions_v2.status, sessions_v2.mode, sessions_v2.learning_objective, sessions_v2.cognitive_status, sessions_v2.session_metrics, sessions_v2.start_time, sessions_v2.end_time, sessions_v2.created_at, users.id, users.email, users.username, users.hashed_password, users.full_name, users.roles, users.is_active, users.created_at AS created_at_1, users.deleted_at 
FROM sessions_v2 LEFT OUTER JOIN users ON sessions_v2.user_id = users.id 
WHERE sessions_v2.activity_id = $1::VARCHAR ORDER BY users.full_name, users.username
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00243s] ('f31204ea-8711-408b-8bdf-46087f7bef37',)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT DISTINCT s.student_id, u.full_name, u.email
            FROM submissions s
            LEFT JOIN users u ON s.student_id = u.id
            WHERE s.activity_id = $1
              AND NOT EXISTS (
                  SELECT 1 FROM sessions_v2 sv
                  WHERE sv.user_id = s.student_id 
                    AND sv.activity_id = s.activity_id
              )
            ORDER BY u.full_name, u.email
        
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00212s] ('f31204ea-8711-408b-8bdf-46087f7bef37',)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _connection_rollback_impl:2702 - ROLLBACK
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT activity_id, course_id, teacher_id, title, subject, instructions, status, policies, created_at
            FROM activities
            WHERE activity_id = $1
        
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.1477s ago] ('f31204ea-8711-408b-8bdf-46087f7bef37',)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT activity_id, course_id, teacher_id, title, subject, instructions, status, policies, created_at
            FROM activities
            WHERE activity_id = $1
        
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.1612s ago] ('f31204ea-8711-408b-8bdf-46087f7bef37',)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT exercise_id, title, description, difficulty, language, 
                       mission_markdown, starter_code, solution_code, test_cases
                FROM exercises_v2
                WHERE activity_id = $1
                ORDER BY created_at ASC
                
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.06117s ago] ('f31204ea-8711-408b-8bdf-46087f7bef37',)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _connection_rollback_impl:2702 - ROLLBACK
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT 
                    ea.exercise_id,
                    e.title,
                    ea.grade,
                    ea.ai_feedback
                FROM exercise_attempts_v2 ea
                JOIN exercises_v2 e ON ea.exercise_id = e.exercise_id
                WHERE ea.session_id = $1 
                  AND e.activity_id = $2
                  AND ea.attempt_id = (
                      SELECT attempt_id FROM exercise_attempts_v2 
                      WHERE exercise_id = ea.exercise_id AND session_id = $1
                      ORDER BY submitted_at DESC LIMIT 1
                  )
                ORDER BY e.unit_number
            
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00243s] ('4281b589-3004-4798-b1cc-3d8199e48d9a', 'f31204ea-8711-408b-8bdf-46087f7bef37')
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT activity_id, course_id, teacher_id, title, subject, instructions, status, policies, created_at
            FROM activities
            WHERE activity_id = $1
        
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.1992s ago] ('f31204ea-8711-408b-8bdf-46087f7bef37',)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _connection_rollback_impl:2702 - ROLLBACK
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT DISTINCT
                    u.id as student_id,
                    u.email,
                    u.full_name,
                    COUNT(DISTINCT ex.exercise_id) as total_exercises,
                    COUNT(DISTINCT CASE WHEN att.passed = true THEN ex.exercise_id END) as submitted_exercises,
                    COUNT(DISTINCT CASE WHEN att.passed = true THEN ex.exercise_id END) as graded_exercises,
                    AVG(CASE WHEN att.passed = true THEN 10 ELSE 5 END) as avg_score,
                    MAX(att.submitted_at) as last_submission
                FROM users u
                INNER JOIN sessions_v2 s ON s.user_id = u.id
                CROSS JOIN exercises_v2 ex
                LEFT JOIN exercise_attempts_v2 att ON att.exercise_id = ex.exercise_id AND att.user_id = u.id
                WHERE s.activity_id = $1
                AND u.roles @> '["student"]'::jsonb
                GROUP BY u.id, u.email, u.full_name
                ORDER BY u.full_name
            
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.1641s ago] ('f31204ea-8711-408b-8bdf-46087f7bef37',)
2026-02-03 13:26:56 - backend.src_v3.infrastructure.http.api.v3.routers.analytics_router - INFO - get_activity_submissions_analytics:310 - Student 91880ff2-3d5b-4ee9-acb5-61dafccf74b6 - Found 0 exercises, 0 graded, total: 0
2026-02-03 13:26:56 - backend.src_v3.infrastructure.http.api.v3.routers.analytics_router - INFO - get_activity_submissions_analytics:316 - Grade from session_metrics: None
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                    SELECT final_grade 
                    FROM submissions 
                    WHERE student_id = $1 AND activity_id = $2
                    ORDER BY created_at DESC LIMIT 1
                
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00250s] ('91880ff2-3d5b-4ee9-acb5-61dafccf74b6', 'f31204ea-8711-408b-8bdf-46087f7bef37')
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _connection_rollback_impl:2702 - ROLLBACK
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT risk_level, risk_dimension, description, recommendations
                FROM risks_v2
                WHERE session_id = $1
                ORDER BY created_at DESC LIMIT 1
            
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00186s] ('4281b589-3004-4798-b1cc-3d8199e48d9a',)
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT 
                    ea.exercise_id,
                    e.title,
                    ea.grade,
                    ea.ai_feedback
                FROM exercise_attempts_v2 ea
                JOIN exercises_v2 e ON ea.exercise_id = e.exercise_id
                WHERE ea.session_id = $1 
                  AND e.activity_id = $2
                  AND ea.attempt_id = (
                      SELECT attempt_id FROM exercise_attempts_v2 
                      WHERE exercise_id = ea.exercise_id AND session_id = $1
                      ORDER BY submitted_at DESC LIMIT 1
                  )
                ORDER BY e.unit_number
            
2026-02-03 13:26:56 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.0586s ago] ('25d34034-7275-423d-ad25-347c5b99e39d', 'f31204ea-8711-408b-8bdf-46087f7bef37')
2026-02-03 13:26:56 - backend.src_v3.infrastructure.http.api.v3.routers.analytics_router - INFO - get_activity_submissions_analytics:310 - Student 91880ff2-3d5b-4ee9-acb5-61dafccf74b6 - Found 0 exercises, 0 graded, total: 0
2026-02-03 13:26:57 - backend.src_v3.infrastructure.http.api.v3.routers.analytics_router - INFO - get_activity_submissions_analytics:316 - Grade from session_metrics: None
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                    SELECT final_grade 
                    FROM submissions 
                    WHERE student_id = $1 AND activity_id = $2
                    ORDER BY created_at DESC LIMIT 1
                
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.03068s ago] ('91880ff2-3d5b-4ee9-acb5-61dafccf74b6', 'f31204ea-8711-408b-8bdf-46087f7bef37')
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _connection_rollback_impl:2702 - ROLLBACK
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT risk_level, risk_dimension, description, recommendations
                FROM risks_v2
                WHERE session_id = $1
                ORDER BY created_at DESC LIMIT 1
            
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.02616s ago] ('25d34034-7275-423d-ad25-347c5b99e39d',)
2026-02-03 13:26:57 - backend.src_v3.infrastructure.http.api.v3.routers.analytics_router - INFO - get_activity_submissions_analytics:535 - Retrieved 2 total analytics (sessions + submissions) for activity f31204ea-8711-408b-8bdf-46087f7bef37
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - SELECT activities.activity_id, activities.title, activities.subject, activities.unit_id, activities.teacher_id, activities.course_id, activities.module_id, activities.order_index, activities.instructions, activities.status, activities.difficulty_level, activities.policies, activities.start_date, activities.end_date, activities.created_at, activities.deleted_at 
FROM activities 
WHERE activities.activity_id = $1::VARCHAR
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.1941s ago] ('f31204ea-8711-408b-8bdf-46087f7bef37',)
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - SELECT sessions_v2.session_id, sessions_v2.user_id, sessions_v2.activity_id, sessions_v2.course_id, sessions_v2.status, sessions_v2.mode, sessions_v2.learning_objective, sessions_v2.cognitive_status, sessions_v2.session_metrics, sessions_v2.start_time, sessions_v2.end_time, sessions_v2.created_at, users.id, users.email, users.username, users.hashed_password, users.full_name, users.roles, users.is_active, users.created_at AS created_at_1, users.deleted_at 
FROM sessions_v2 LEFT OUTER JOIN users ON sessions_v2.user_id = users.id 
WHERE sessions_v2.activity_id = $1::VARCHAR ORDER BY users.full_name, users.username
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.1631s ago] ('f31204ea-8711-408b-8bdf-46087f7bef37',)
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT DISTINCT s.student_id, u.full_name, u.email
            FROM submissions s
            LEFT JOIN users u ON s.student_id = u.id
            WHERE s.activity_id = $1
              AND NOT EXISTS (
                  SELECT 1 FROM sessions_v2 sv
                  WHERE sv.user_id = s.student_id 
                    AND sv.activity_id = s.activity_id
              )
            ORDER BY u.full_name, u.email
        
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.1491s ago] ('f31204ea-8711-408b-8bdf-46087f7bef37',)
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT 
                    ea.exercise_id,
                    e.title,
                    ea.grade,
                    ea.ai_feedback
                FROM exercise_attempts_v2 ea
                JOIN exercises_v2 e ON ea.exercise_id = e.exercise_id
                WHERE ea.session_id = $1 
                  AND e.activity_id = $2
                  AND ea.attempt_id = (
                      SELECT attempt_id FROM exercise_attempts_v2 
                      WHERE exercise_id = ea.exercise_id AND session_id = $1
                      ORDER BY submitted_at DESC LIMIT 1
                  )
                ORDER BY e.unit_number
            
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.1016s ago] ('4281b589-3004-4798-b1cc-3d8199e48d9a', 'f31204ea-8711-408b-8bdf-46087f7bef37')
2026-02-03 13:26:57 - backend.src_v3.infrastructure.http.api.v3.routers.analytics_router - INFO - get_activity_submissions_analytics:310 - Student 91880ff2-3d5b-4ee9-acb5-61dafccf74b6 - Found 0 exercises, 0 graded, total: 0
2026-02-03 13:26:57 - backend.src_v3.infrastructure.http.api.v3.routers.analytics_router - INFO - get_activity_submissions_analytics:316 - Grade from session_metrics: None
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                    SELECT final_grade 
                    FROM submissions 
                    WHERE student_id = $1 AND activity_id = $2
                    ORDER BY created_at DESC LIMIT 1
                
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.07403s ago] ('91880ff2-3d5b-4ee9-acb5-61dafccf74b6', 'f31204ea-8711-408b-8bdf-46087f7bef37')
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT risk_level, risk_dimension, description, recommendations
                FROM risks_v2
                WHERE session_id = $1
                ORDER BY created_at DESC LIMIT 1
            
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.06712s ago] ('4281b589-3004-4798-b1cc-3d8199e48d9a',)
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT 
                    ea.exercise_id,
                    e.title,
                    ea.grade,
                    ea.ai_feedback
                FROM exercise_attempts_v2 ea
                JOIN exercises_v2 e ON ea.exercise_id = e.exercise_id
                WHERE ea.session_id = $1 
                  AND e.activity_id = $2
                  AND ea.attempt_id = (
                      SELECT attempt_id FROM exercise_attempts_v2 
                      WHERE exercise_id = ea.exercise_id AND session_id = $1
                      ORDER BY submitted_at DESC LIMIT 1
                  )
                ORDER BY e.unit_number
            
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.1193s ago] ('25d34034-7275-423d-ad25-347c5b99e39d', 'f31204ea-8711-408b-8bdf-46087f7bef37')
2026-02-03 13:26:57 - backend.src_v3.infrastructure.http.api.v3.routers.analytics_router - INFO - get_activity_submissions_analytics:310 - Student 91880ff2-3d5b-4ee9-acb5-61dafccf74b6 - Found 0 exercises, 0 graded, total: 0
2026-02-03 13:26:57 - backend.src_v3.infrastructure.http.api.v3.routers.analytics_router - INFO - get_activity_submissions_analytics:316 - Grade from session_metrics: None
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                    SELECT final_grade 
                    FROM submissions 
                    WHERE student_id = $1 AND activity_id = $2
                    ORDER BY created_at DESC LIMIT 1
                
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.08989s ago] ('91880ff2-3d5b-4ee9-acb5-61dafccf74b6', 'f31204ea-8711-408b-8bdf-46087f7bef37')
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT risk_level, risk_dimension, description, recommendations
                FROM risks_v2
                WHERE session_id = $1
                ORDER BY created_at DESC LIMIT 1
            
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 0.08251s ago] ('25d34034-7275-423d-ad25-347c5b99e39d',)
2026-02-03 13:26:57 - backend.src_v3.infrastructure.http.api.v3.routers.analytics_router - INFO - get_activity_submissions_analytics:535 - Retrieved 2 total analytics (sessions + submissions) for activity f31204ea-8711-408b-8bdf-46087f7bef37
2026-02-03 13:26:57 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:27:00 - sqlalchemy.engine.Engine - INFO - _connection_begin_impl:2699 - BEGIN (implicit)
2026-02-03 13:27:00 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT id, full_name, username, email FROM users WHERE id = $1
        
2026-02-03 13:27:00 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00162s] ('91880ff2-3d5b-4ee9-acb5-61dafccf74b6',)
2026-02-03 13:27:00 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
            SELECT 
                sv.session_id,
                sv.activity_id,
                a.title as activity_title,
                sv.status,
                sv.cognitive_status,
                sv.session_metrics,
                sv.start_time,
                sv.end_time,
                sv.user_id
            FROM sessions_v2 sv
            LEFT JOIN activities a ON sv.activity_id = a.activity_id
            WHERE sv.user_id = $1
         AND sv.activity_id = $2 ORDER BY sv.start_time DESC LIMIT 1
2026-02-03 13:27:00 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00150s] ('91880ff2-3d5b-4ee9-acb5-61dafccf74b6', 'f31204ea-8711-408b-8bdf-46087f7bef37')
2026-02-03 13:27:00 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT 
                    timestamp,
                    interaction_type,
                    interactional_data,
                    cognitive_reasoning,
                    COALESCE(ai_involvement, 0) as frustration,
                    COALESCE(ai_involvement, 0.5) as understanding
                FROM cognitive_traces_v2
                WHERE session_id = $1
                ORDER BY timestamp
            
2026-02-03 13:27:00 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00167s] ('4281b589-3004-4798-b1cc-3d8199e48d9a',)
2026-02-03 13:27:00 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT DISTINCT ON (ea.exercise_id)
                    ea.exercise_id,
                    e.title,
                    CASE WHEN ea.passed THEN 'passed' ELSE 'failed' END as status,
                    ea.code_submitted,
                    ea.ai_feedback,
                    ea.grade,
                    ea.submitted_at
                FROM exercise_attempts_v2 ea
                JOIN exercises_v2 e ON ea.exercise_id = e.exercise_id
                WHERE ea.session_id = $1 AND e.activity_id = $2
                ORDER BY ea.exercise_id, ea.submitted_at DESC
            
2026-02-03 13:27:00 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00146s] ('4281b589-3004-4798-b1cc-3d8199e48d9a', 'f31204ea-8711-408b-8bdf-46087f7bef37')
2026-02-03 13:27:00 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT final_grade, ai_feedback, status
                FROM submissions
                WHERE student_id = $1 AND activity_id = $2
                ORDER BY submitted_at DESC LIMIT 1
            
2026-02-03 13:27:00 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00178s] ('91880ff2-3d5b-4ee9-acb5-61dafccf74b6', 'f31204ea-8711-408b-8bdf-46087f7bef37')
2026-02-03 13:27:00 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT final_grade, test_results
                FROM submissions
                WHERE student_id = $1 AND activity_id = $2
                ORDER BY created_at DESC LIMIT 1
            
2026-02-03 13:27:00 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [generated in 0.00130s] ('91880ff2-3d5b-4ee9-acb5-61dafccf74b6', 'f31204ea-8711-408b-8bdf-46087f7bef37')
2026-02-03 13:27:00 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - 
                SELECT risk_level, risk_dimension, description, recommendations
                FROM risks_v2
                WHERE session_id = $1
                ORDER BY created_at DESC LIMIT 1
            
2026-02-03 13:27:00 - sqlalchemy.engine.Engine - INFO - _execute_context:1843 - [cached since 3.994s ago] ('4281b589-3004-4798-b1cc-3d8199e48d9a',)
2026-02-03 13:27:00 - sqlalchemy.engine.Engine - INFO - _connection_commit_impl:2705 - COMMIT
2026-02-03 13:27:24 - watchfiles.main - INFO - _log_changes:308 - 8 changes detected
2026-02-03 13:27:24 - backend.src_v3.infrastructure.http.app - INFO - lifespan:65 - Shutting down application...
2026-02-03 13:27:25 - root - INFO - setup_logging:116 - ============================================================
2026-02-03 13:27:25 - root - INFO - setup_logging:117 - ðŸš€ AI-Native MVP V3 - Logging initialized
2026-02-03 13:27:25 - root - INFO - setup_logging:118 - ðŸ“ Log Level: INFO
2026-02-03 13:27:25 - root - INFO - setup_logging:119 - ðŸ“ Log Directory: /app/logs
2026-02-03 13:27:25 - root - INFO - setup_logging:120 - ðŸ’¾ File Logging: âœ… Enabled
2026-02-03 13:27:25 - root - INFO - setup_logging:121 - ðŸ”” Sentry Alerts: âŒ Disabled
2026-02-03 13:27:25 - root - INFO - setup_logging:122 - ============================================================
2026-02-03 13:27:25 - root - INFO - setup_logging:116 - ============================================================
2026-02-03 13:27:25 - root - INFO - setup_logging:117 - ðŸš€ AI-Native MVP V3 - Logging initialized
2026-02-03 13:27:25 - root - INFO - setup_logging:118 - ðŸ“ Log Level: INFO
2026-02-03 13:27:25 - root - INFO - setup_logging:119 - ðŸ“ Log Directory: /app/logs
2026-02-03 13:27:25 - root - INFO - setup_logging:120 - ðŸ’¾ File Logging: âœ… Enabled
2026-02-03 13:27:25 - root - INFO - setup_logging:121 - ðŸ”” Sentry Alerts: âŒ Disabled
2026-02-03 13:27:25 - root - INFO - setup_logging:122 - ============================================================
2026-02-03 13:27:26 - watchfiles.main - INFO - _log_changes:308 - 1 change detected
2026-02-03 13:27:26 - watchfiles.main - INFO - _log_changes:308 - 5 changes detected
2026-02-03 13:27:26 - root - INFO - setup_logging:116 - ============================================================
2026-02-03 13:27:26 - root - INFO - setup_logging:117 - ðŸš€ AI-Native MVP V3 - Logging initialized
2026-02-03 13:27:26 - root - INFO - setup_logging:118 - ðŸ“ Log Level: INFO
2026-02-03 13:27:26 - root - INFO - setup_logging:119 - ðŸ“ Log Directory: /app/logs
2026-02-03 13:27:26 - root - INFO - setup_logging:120 - ðŸ’¾ File Logging: âœ… Enabled
2026-02-03 13:27:26 - root - INFO - setup_logging:121 - ðŸ”” Sentry Alerts: âŒ Disabled
2026-02-03 13:27:26 - root - INFO - setup_logging:122 - ============================================================
2026-02-03 13:27:26 - root - INFO - setup_logging:116 - ============================================================
2026-02-03 13:27:26 - root - INFO - setup_logging:117 - ðŸš€ AI-Native MVP V3 - Logging initialized
2026-02-03 13:27:26 - root - INFO - setup_logging:118 - ðŸ“ Log Level: INFO
2026-02-03 13:27:26 - root - INFO - setup_logging:119 - ðŸ“ Log Directory: /app/logs
2026-02-03 13:27:26 - root - INFO - setup_logging:120 - ðŸ’¾ File Logging: âœ… Enabled
2026-02-03 13:27:26 - root - INFO - setup_logging:121 - ðŸ”” Sentry Alerts: âŒ Disabled
2026-02-03 13:27:26 - root - INFO - setup_logging:122 - ============================================================
2026-02-03 13:27:26 - watchfiles.main - INFO - _log_changes:308 - 1 change detected
2026-02-03 13:27:27 - watchfiles.main - INFO - _log_changes:308 - 15 changes detected
2026-02-03 13:27:27 - watchfiles.main - INFO - _log_changes:308 - 2 changes detected
2026-02-03 13:27:28 - watchfiles.main - INFO - _log_changes:308 - 5 changes detected
2026-02-03 13:27:29 - watchfiles.main - INFO - _log_changes:308 - 4 changes detected
2026-02-03 13:27:32 - backend.src_v3.infrastructure.http.app - INFO - create_app:175 - Application created successfully
2026-02-03 13:27:32 - backend.src_v3.infrastructure.http.app - INFO - create_app:175 - Application created successfully
2026-02-03 13:27:32 - backend.src_v3.infrastructure.http.app - INFO - lifespan:53 - Starting AI-Native MVP V3 (Clean Architecture)
2026-02-03 13:27:32 - backend.src_v3.infrastructure.http.app - INFO - lifespan:54 - Initializing database connection...
